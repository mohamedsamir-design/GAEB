<app-header 
  [pageTitle]="'ุชุทุจูู ุงูุงุฑุงุถู - ุจูุงูุงุช ุงููุฑุงูู'"
  [pageSubtitle]="'ุงุฎุชุฑ ุงูุนูููุฉ ุงููุทููุจุฉ'"
  [showBackButton]="true"
  [showHomeButton]="true"
  [backButtonLabel]="'ุงูุนูุฏุฉ'"
  [backButtonAriaLabel]="'ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ'"
  (backClicked)="goBack()"
  (homeClicked)="goHome()"
  (logoutClicked)="logout()">
</app-header>

<div class="container">

  <h2 class="title">ุจุญุซ ุนู ูุฑุงูู ุงููุจูู</h2>

  <!-- Search Box -->
  <div class="search-box">
    <input 
      type="text" 
      [(ngModel)]="buildingNumber" 
      placeholder="ุฃุฏุฎู ุฑูู ุงููุจูู" 
      class="search-input"
      (keyup.enter)="searchAmenities()">

    <button class="search-btn" (click)="searchAmenities()">
      ๐ <span>ุจุญุซ</span>
    </button>
  </div>

  <!-- Results Section -->
  <div *ngIf="hasSearched" class="results-section">

    <!-- Add Button -->
    <div class="add-button-container">
      <button (click)="openAddModal()" class="add-btn-large">
        โ ุฅุถุงูุฉ ูุฑูู ุฌุฏูุฏ
      </button>
    </div>

    <!-- Table -->
    <table class="amenities-table" *ngIf="amenities.length > 0">
      <thead>
        <tr>
          <th>ุงุณู ุงููุจูู</th>
          <th>ุงุณู ุงููุฑูู</th>
          <th>ุงูุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let a of amenities">
          <td>{{ a.buildingName }}</td>
          <td>{{ a.name }}</td>
          <td class="actions-cell">
            <div class="actions">
              <button (click)="deleteAmenity(a)" class="action-btn delete-btn" title="ุญุฐู">
                โ
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Empty State -->
    <div *ngIf="amenities.length === 0" class="empty-state">
      <div class="empty-icon">โโ</div>
      <p>ูุง ุชูุฌุฏ ูุฑุงูู ูุณุฌูุฉ ูุฑูู ุงููุจูู: <strong>{{ buildingNumber }}</strong></p>
      <button (click)="openAddModal()" class="add-btn-large mt-4">
        add_circle_outline ุฅุถุงูุฉ ูุฑูู ุฌุฏูุฏ ููุฐุง ุงููุจูู
      </button>
    </div>

  </div>
</div>

<!-- Modal ูุฅุถุงูุฉ ูุฑูู -->
<div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>ุงุฎุชูุงุฑ ูุฑูู ูุฅุถุงูุชู ุฅูู ุงููุจูู ุฑูู {{ buildingNumber }}</h3>
      <button class="close-btn" (click)="closeModal()">โ</button>
    </div>

    <div class="modal-body">
      <table class="modal-table">
        <thead>
          <tr>
            <th>ุงุฎุชุฑ</th>
            <th>ุงุณู ุงููุฑูู</th>
            <th>ุงููุตู</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of availableAmenities; let i = index">
            <td class="checkbox-cell">
              <label class="checkbox-label">
                <input type="checkbox" 
                       [(ngModel)]="item.selected"
                       (change)="onAmenitySelect(item)">
                <span class="checkmark"></span>
              </label>
            </td>
            <td>{{ item.name }}</td>
            <td>{{ item.description }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="modal-footer">
      <button class="btn-cancel" (click)="closeModal()">ุฅูุบุงุก</button>
      <button class="btn-confirm" 
              [disabled]="!hasSelectedAmenities()"
              (click)="confirmAddAmenities()">
        ๐พ ุฅุถุงูุฉ ุงููุฑุงูู ุงููุญุฏุฏุฉ
      </button>
    </div>
  </div>
</div>