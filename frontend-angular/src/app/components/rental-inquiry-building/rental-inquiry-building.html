<app-header 
  [pageTitle]="'Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù…ÙˆÙ‚Ø¹ Ù…Ø¨Ù†Ù‰ Ù…Ø¤Ø¬Ø±'"
  [showBackButton]="true"
  [showHomeButton]="true"
  (backClicked)="goBack()"
  (homeClicked)="goHome()"
  (logoutClicked)="logout()"
></app-header>

<div class="container">
  <div class="search-section">
    <div class="search-card">
      <h2>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¨Ù†Ù‰</h2>
      <div class="search-group">
        <label for="id">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ:</label>
        <div class="search-input-group">
          <input 
            id="id"
            type="text" 
            [(ngModel)]="identificationNumber"
            placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ"
            class="search-input"
          />
          <button class="btn-search" (click)="search()">ğŸ” Ø¨Ø­Ø«</button>
        </div>
      </div>
    </div>
  </div>

  @if (buildingInfo()) {
    <div class="building-info-section">
      <div class="info-card">
        <div class="info-header">
          <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ù†Ù‰</h3>
        </div>
        <div class="info-grid">
          <div class="info-row">
            <span class="info-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©:</span>
            <span class="info-value">{{ buildingInfo()?.name }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Ø§Ù„Ù…ÙˆÙ‚Ù Ø§Ù„Ù…Ø³Ø¬Ù„:</span>
            <span class="info-value">{{ buildingInfo()?.status }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Ø§Ù„Ù…ÙˆÙ‚Ù Ø§Ù„ÙØ±Ø¹ÙŠ:</span>
            <span class="info-value">{{ buildingInfo()?.substatus }}</span>
          </div>
        </div>

        <div class="button-group">
          <button class="btn-option" (click)="viewDetails()">
            â„¹ï¸ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ø§Ù„Ù…Ø¨Ù†Ù‰
          </button>
          <button class="btn-option btn-edit" (click)="navigateToEdit()">
            âœ ØªØ¹Ø¯ÙŠÙ„ Ù…ÙˆÙ‚Ù Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ Ø§Ù„Ù…Ø¤Ø¬Ø±Ø©
          </button>
        </div>
      </div>

      @if (showDetails()) {
        <div class="details-card">
          <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„ÙƒØ§Ù…Ù„Ø©</h3>
          <div class="details-grid">
            <!-- Basic Identification -->
            <div class="detail-row">
              <span class="detail-label">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†ÙŠ:</span>
              <span class="detail-value">{{ buildingDetails()?.identificationNumber || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©:</span>
              <span class="detail-value">{{ buildingDetails()?.name || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Location Information -->
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©:</span>
              <span class="detail-value">{{ buildingDetails()?.governorate || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ù…Ø±ÙƒØ²:</span>
              <span class="detail-value">{{ buildingDetails()?.regionalCenter || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„Ø§Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.educationalAdministration || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Educational Information -->
            <div class="detail-row">
              <span class="detail-label">Ù†ÙˆØ¹ÙŠØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ…:</span>
              <span class="detail-value">{{ buildingDetails()?.educationType || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„ØªØ¨Ø¹ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.affiliation || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ù…ÙˆÙ‚Ù Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</span>
              <span class="detail-value">{{ buildingDetails()?.usageStatus || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.stage || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Usage and Students -->
            <div class="detail-row">
              <span class="detail-label">ÙØªØ±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</span>
              <span class="detail-value">{{ buildingDetails()?.usagePeriods || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„Ù†ÙˆØ¹ (Ø§Ù„Ø¬Ù†Ø³):</span>
              <span class="detail-value">{{ buildingDetails()?.gender || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ø³Ù… Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.secondPeriodSchoolName || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ø³Ù… Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©:</span>
              <span class="detail-value">{{ buildingDetails()?.thirdPeriodSchoolName || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ø¬Ù…Ø§Ù„ÙŠ ØªÙ„Ø§Ù…ÙŠØ° Ø§Ù„Ù…Ø¯Ø±Ø³Ø©:</span>
              <span class="detail-value">{{ buildingDetails()?.totalStudents || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø¨Ù†ÙŠÙ†:</span>
              <span class="detail-value">{{ buildingDetails()?.boysCount || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø¨Ù†Ø§Øª:</span>
              <span class="detail-value">{{ buildingDetails()?.girlsCount || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Ownership and Areas -->
            <div class="detail-row">
              <span class="detail-label">Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø§Ø±Ø¶:</span>
              <span class="detail-value">{{ buildingDetails()?.landOwnership || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ù…Ø¨Ù†ÙŠ:</span>
              <span class="detail-value">{{ buildingDetails()?.buildingOwnership || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹:</span>
              <span class="detail-value">{{ buildingDetails()?.landArea ? (buildingDetails()?.landArea + ' Ù…Â²') : 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ù…Ø³Ø·Ø­ Ø§Ù„Ù…Ø¨Ù†ÙŠ:</span>
              <span class="detail-value">{{ buildingDetails()?.builtArea ? (buildingDetails()?.builtArea + ' Ù…Â²') : 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„Ø§Ø­Ù‚:</span>
              <span class="detail-value">{{ buildingDetails()?.annexesCount || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Building Features -->
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„Ø³ÙˆØ±:</span>
              <span class="detail-value">{{ buildingDetails()?.fenceType || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ù†Ø´Ø§Ø¡:</span>
              <span class="detail-value">{{ buildingDetails()?.constructionSystem || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ù†Ø´Ø§Ø¡:</span>
              <span class="detail-value">{{ buildingDetails()?.constructionMethod || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Utilities -->
            <div class="detail-row">
              <span class="detail-label">Ù…ØµØ¯Ø± Ø§Ù„ØªÙŠØ§Ø±:</span>
              <span class="detail-value">{{ buildingDetails()?.powerSource || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„ØµØ±Ù Ø§Ù„ØµØ­ÙŠ:</span>
              <span class="detail-value">{{ buildingDetails()?.sewerageSystem || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø§Ù„ØªØºØ°ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.waterSupply || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            
            <!-- Spaces -->
            <div class="detail-row">
              <span class="detail-label">Ø¹Ø¯Ø¯ Ø§Ù„ÙØµÙˆÙ„:</span>
              <span class="detail-value">{{ buildingDetails()?.classroomsCount || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ø§ØºØ§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.educationalSpacesCount || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.hostingStatus || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±Ø§ØºØ§Øª Ø§Ù„ØªÙƒÙ…ÙŠÙ„ÙŠØ©:</span>
              <span class="detail-value">{{ buildingDetails()?.complementarySpacesCount || 'ØºÙŠØ± Ù…ØªÙˆÙØ±' }}</span>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>

<app-rental-status-edit
  [buildingId]="buildingInfo()?.identificationNumber || ''"
  [currentStatus]="buildingInfo()?.status || ''"
  [currentSubstatus]="buildingInfo()?.substatus || ''"
  [isOpen]="showEditPopup()"
  (closePopup)="closeEditPopup()"
  (submitSuccess)="handleEditSubmit($event)"
></app-rental-status-edit>
