<app-header 
  [pageTitle]="'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©'"
  [showBackButton]="true"
  [showHomeButton]="true"
  (backClicked)="navigateBack()"
  (homeClicked)="goHome()"
  (logoutClicked)="logout()"
></app-header>

<div class="container">
  <div class="page-content">
    <h1>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h1>
    <p class="subtitle">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</p>

    <!-- Search Form -->
    <div class="form-wrapper">
      <form [formGroup]="searchForm" (ngSubmit)="onSearch()">
        <div class="form-row">
          <div class="form-group">
            <label for="buildingCode">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†Ù‰ <span class="required">*</span></label>
            <input 
              type="text" 
              id="buildingCode" 
              formControlName="buildingCode"
              placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†Ù‰"
              [class.error]="searchForm.get('buildingCode')?.invalid && searchForm.get('buildingCode')?.touched"
            />
            @if (searchForm.get('buildingCode')?.invalid && searchForm.get('buildingCode')?.touched) {
              <span class="error-message">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†Ù‰ Ù…Ø·Ù„ÙˆØ¨</span>
            }
          </div>

          <div class="form-group">
            <label for="centerCode">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø±ÙƒØ² <span class="required">*</span></label>
            <input 
              type="text" 
              id="centerCode" 
              formControlName="centerCode"
              placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø±ÙƒØ²"
              [class.error]="searchForm.get('centerCode')?.invalid && searchForm.get('centerCode')?.touched"
            />
            @if (searchForm.get('centerCode')?.invalid && searchForm.get('centerCode')?.touched) {
              <span class="error-message">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø±ÙƒØ² Ù…Ø·Ù„ÙˆØ¨</span>
            }
          </div>

          <div class="form-group">
            <label for="branchCode">ÙƒÙˆØ¯ Ø§Ù„ÙØ±Ø¹ <span class="required">*</span></label>
            <input 
              type="text" 
              id="branchCode" 
              formControlName="branchCode"
              placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ÙØ±Ø¹"
              [class.error]="searchForm.get('branchCode')?.invalid && searchForm.get('branchCode')?.touched"
            />
            @if (searchForm.get('branchCode')?.invalid && searchForm.get('branchCode')?.touched) {
              <span class="error-message">ÙƒÙˆØ¯ Ø§Ù„ÙØ±Ø¹ Ù…Ø·Ù„ÙˆØ¨</span>
            }
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            <span>ğŸ”</span>
            Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Results Modal -->
@if (showModal()) {
  <div class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h2>
        <button class="modal-close" (click)="closeModal()">Ã—</button>
      </div>

      <div class="modal-body">
        @if (studyPeriodData().length > 0) {
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Ø§Ù„ÙØªØ±Ø©</th>
                  <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th>
                  <th>Ø§Ù„Ù†ÙˆØ¹</th>
                  <th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ„Ø§Ù…ÙŠØ° Ø¨Ù†ÙŠÙ†</th>
                  <th>Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ„Ø§Ù…ÙŠØ° Ø¨Ù†Ø§Øª</th>
                  <th>Ù…Ø±Ø­Ù„Ø© Ø§Ù„ÙØªØ±Ø©</th>
                </tr>
              </thead>
              <tbody>
                @for (item of studyPeriodData(); track $index) {
                  <tr>
                    <td>{{ $index + 1 }}</td>
                    <td>{{ item.period }}</td>
                    <td>{{ item.schoolName }}</td>
                    <td>{{ item.type }}</td>
                    <td>{{ item.boysCount }}</td>
                    <td>{{ item.girlsCount }}</td>
                    <td>{{ item.periodStage }}</td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        } @else {
          <div class="empty-state">
            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø©</p>
          </div>
        }
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>
}
