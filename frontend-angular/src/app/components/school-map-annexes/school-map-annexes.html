<app-header 
  [pageTitle]="'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø­Ù‚'"
  [showBackButton]="true"
  [showHomeButton]="true"
  (backClicked)="navigateBack()"
  (homeClicked)="goHome()"
  (logoutClicked)="logout()"
></app-header>

<div class="container">
  <div class="page-content">
    <h1>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø­Ù‚</h1>
    <p class="subtitle">Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø­Ù‚</p>

    <!-- Search Form -->
    <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="search-form">
      <div class="form-row">
        <div class="form-group">
          <label>ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†ÙŠ <span class="required">*</span></label>
          <input 
            type="text" 
            formControlName="buildingCode"
            [class.error]="searchForm.get('buildingCode')?.invalid && searchForm.get('buildingCode')?.touched"
            placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†ÙŠ"
          />
          @if (searchForm.get('buildingCode')?.invalid && searchForm.get('buildingCode')?.touched) {
            <span class="error-message">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¨Ù†ÙŠ Ù…Ø·Ù„ÙˆØ¨</span>
          }
        </div>

        <div class="form-group">
          <label>Ù…Ø³Ù„Ø³Ù„ Ø§Ù„Ù…Ù„Ø­Ù‚ <span class="required">*</span></label>
          <input 
            type="text" 
            formControlName="annexSerial"
            [class.error]="searchForm.get('annexSerial')?.invalid && searchForm.get('annexSerial')?.touched"
            placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø³Ù„Ø³Ù„ Ø§Ù„Ù…Ù„Ø­Ù‚"
          />
          @if (searchForm.get('annexSerial')?.invalid && searchForm.get('annexSerial')?.touched) {
            <span class="error-message">Ù…Ø³Ù„Ø³Ù„ Ø§Ù„Ù…Ù„Ø­Ù‚ Ù…Ø·Ù„ÙˆØ¨</span>
          }
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary">
          <span>ğŸ”</span>
          Ø¨Ø­Ø«
        </button>
        <button type="button" class="btn btn-secondary" (click)="onReset()">
          <span>â†º</span>
          Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
        </button>
      </div>
    </form>

    <!-- Annex Details -->
    @if (showDetails() && annexData()) {
      <div class="details-container">
        <!-- Basic Info -->
        <div class="info-section">
          <h2 class="section-title">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Ø§Ø³Ù… Ø§Ù„Ù…Ø¨Ù†ÙŠ:</span>
              <span class="value">{{ annexData()!.buildingName }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±:</span>
              <span class="value">{{ annexData()!.floorsCount }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</span>
              <span class="value">{{ annexData()!.totalArea }}</span>
            </div>
          </div>
        </div>

        <!-- Structural Condition -->
        <div class="info-section">
          <h2 class="section-title">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù†Ø´Ø§Ø¦ÙŠØ©</h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Ø§Ù„Ù‡ÙŠÙƒÙ„:</span>
              <span class="value">{{ annexData()!.structuralCondition.structure }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡:</span>
              <span class="value">{{ annexData()!.structuralCondition.electricity }}</span>
            </div>
            <div class="info-item">
              <span class="label">ØªØ´Ø·ÙŠØ¨Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ©:</span>
              <span class="value">{{ annexData()!.structuralCondition.interiorFinishing }}</span>
            </div>
            <div class="info-item">
              <span class="label">ØµØ­ÙŠ:</span>
              <span class="value">{{ annexData()!.structuralCondition.sanitary }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„Ù…Ø¨Ù†ÙŠ Ù„Ù„ØªØ¹Ù„ÙŠØ©:</span>
              <span class="value">{{ annexData()!.structuralCondition.expansionCapability }}</span>
            </div>
            <div class="info-item">
              <span class="label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</span>
              <span class="value">{{ annexData()!.structuralCondition.constructionDate }}</span>
            </div>
          </div>
        </div>

        <!-- Construction -->
        <div class="info-section">
          <h2 class="section-title">Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</span>
              <span class="value">{{ annexData()!.construction.constructionSystem }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡:</span>
              <span class="value">{{ annexData()!.construction.constructionMethod }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ø­ÙˆØ§Ø¦Ø· (Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡):</span>
              <span class="value">{{ annexData()!.construction.buildingMaterials.walls }}</span>
            </div>
            <div class="info-item">
              <span class="label">Ø£Ø³Ù‚Ù (Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡):</span>
              <span class="value">{{ annexData()!.construction.buildingMaterials.ceilings }}</span>
            </div>
            <div class="info-item">
              <span class="label">ØªØ´Ø·ÙŠØ¨Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª:</span>
              <span class="value">{{ annexData()!.construction.facadeFinishing }}</span>
            </div>
          </div>
        </div>

        <!-- Finishing Table -->
        <div class="info-section">
          <h2 class="section-title">Ø§Ù„ØªØ´Ø·ÙŠØ¨Ø§Øª</h2>
          <div class="finishing-table-wrapper">
            <table class="finishing-table">
              <thead>
                <tr>
                  <th>Ø§Ù„Ù†ÙˆØ¹</th>
                  <th>ÙØµÙˆÙ„</th>
                  <th>Ø·Ø±Ù‚Ø§Øª</th>
                  <th>Ø¯ÙˆØ±Ø§Øª</th>
                  <th>Ù…Ø¹Ø§Ù…Ù„</th>
                  <th>Ø£Ø®Ø±Ù‰</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="row-label">Ø£Ø±Ø¶ÙŠØ§Øª</td>
                  <td>{{ annexData()!.finishingTable.floors.classrooms }}</td>
                  <td>{{ annexData()!.finishingTable.floors.corridors }}</td>
                  <td>{{ annexData()!.finishingTable.floors.bathrooms }}</td>
                  <td>{{ annexData()!.finishingTable.floors.labs }}</td>
                  <td>{{ annexData()!.finishingTable.floors.other }}</td>
                </tr>
                <tr>
                  <td class="row-label">Ø­ÙˆØ§Ø¦Ø·</td>
                  <td>{{ annexData()!.finishingTable.walls.classrooms }}</td>
                  <td>{{ annexData()!.finishingTable.walls.corridors }}</td>
                  <td>{{ annexData()!.finishingTable.walls.bathrooms }}</td>
                  <td>{{ annexData()!.finishingTable.walls.labs }}</td>
                  <td>{{ annexData()!.finishingTable.walls.other }}</td>
                </tr>
                <tr>
                  <td class="row-label">Ø£Ø³Ù‚Ù</td>
                  <td>{{ annexData()!.finishingTable.ceilings.classrooms }}</td>
                  <td>{{ annexData()!.finishingTable.ceilings.corridors }}</td>
                  <td>{{ annexData()!.finishingTable.ceilings.bathrooms }}</td>
                  <td>{{ annexData()!.finishingTable.ceilings.labs }}</td>
                  <td>{{ annexData()!.finishingTable.ceilings.other }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    }
  </div>
</div>
